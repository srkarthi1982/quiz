---
import { AvIcon } from "@ansiversa/components";

type Size = "sm" | "md";

interface Props {
  active?: boolean;
  activeExpr?: string;
  entityType?: string;
  entityId?: string;
  label?: string;
  size?: Size;
  onToggle: string;
}

const {
  active = false,
  activeExpr,
  entityType = "platform",
  entityId = "",
  label,
  size = "md",
  onToggle,
} = Astro.props as Props;

const iconSize = size === "sm" ? "sm" : "md";
const resolvedActiveExpr = activeExpr ?? (active ? "true" : "false");
---

<button
  type="button"
  class="bookmark-btn"
  :class={`(${resolvedActiveExpr}) ? 'is-active' : ''`}
  @click.stop.prevent={onToggle}
  data-entity-type={entityType}
  data-entity-id={entityId}
  data-label={label ?? ""}
  :aria-pressed={resolvedActiveExpr}
  :title={`(${resolvedActiveExpr}) ? 'Remove bookmark' : 'Save bookmark'`}
>
  <span x-show={`!(${resolvedActiveExpr})`}><AvIcon name="heart" size={iconSize} /></span>
  <span x-show={resolvedActiveExpr}><AvIcon name="heart-filled" size={iconSize} /></span>
</button>

<style>
  .bookmark-btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 2rem;
    height: 2rem;
    border: 1px solid rgba(148, 163, 184, 0.35);
    border-radius: 999px;
    background: rgba(15, 23, 42, 0.65);
    color: #94a3b8;
    transition: all 0.2s ease;
  }
  .bookmark-btn:hover {
    border-color: rgba(14, 165, 233, 0.6);
    color: #7dd3fc;
  }
  .bookmark-btn.is-active {
    border-color: rgba(14, 165, 233, 0.8);
    color: #38bdf8;
    background: rgba(14, 116, 144, 0.25);
  }
</style>
