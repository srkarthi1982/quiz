---
import LayoutFull from "../app/Layout.astro";
---

<LayoutFull active="quiz">
	<div x-data="{ step: 1 }" x-init="$store.quiz.onInit()" class="card flex flex-col items-center p-4">
		<!-- Stepper -->
		<ol class="flex items-center w-full max-w-md">
			<template x-for="(label, index) in ['Choose a Platform', 'Select your Subject', 'Select a Topic', 'Roadmaps', 'Levels', 'Start the Quiz']">
				<li class="flex items-center w-full"
					:class="step >= index + 1 ? 'text-blue-600 after:border-blue-100 cursor-pointer' : 'text-gray-500 after:border-gray-300 cursor-not-allowed'"
					@click="step >= index + 1 ? step = index + 1 : null">
					<div class="flex items-center justify-center w-10 h-10 rounded-full lg:h-12 lg:w-12 shrink-0"
						:class="step >= index + 1 ? 'bg-blue-100' : 'bg-gray-200'">
						<span x-text="index + 1"></span>
					</div>
					<div x-show="index !== 5" class="w-full h-1 border-b border-4"
						:class="step >= index + 1 ? 'border-blue-100' : 'border-gray-200'">
					</div>
				</li>
			</template>
		</ol>
		<!-- Step Label -->
		<h1 class="text-xl font-bold text-center my-5" x-text="['Choose a Platform', 'Select your Subject', 'Select a Topic', 'Roadmaps', 'Levels', 'Start the Quiz'][step - 1]"></h1>
		<!-- Step 1: Select Platform -->
		<div x-show="step === 1" class="w-full text-sm font-medium text-gray-900 bg-white border border-gray-200 rounded-lg">
			<template x-for="platform in $store.quiz.list.platforms" :key="platform.id">
				<button @click="$store.quiz.selection.platform_id = platform.id; $store.quiz.getSubjects(platform.id); step = 2;"
					class="block w-full px-4 py-2 border-b border-gray-200 cursor-pointer text-left"
					:class="$store.quiz.selection.platform_id === platform.id ? 'bg-blue-100 text-blue-700' : 'hover:bg-gray-100 hover:text-blue-700'">
					<i :class="`fas ${platform.icon} text-lg text-gray-600`"></i>
					<span class="ml-2" x-text="platform.name"></span>
				</button>
			</template>
		</div>
		<!-- Step 2: Select Subject -->
		<div x-show="step === 2" class="w-full text-sm font-medium text-gray-900 bg-white border border-gray-200 rounded-lg">
			<template x-for="subject in $store.quiz.list.subjects" :key="subject.id">
				<button @click="$store.quiz.selection.subject_id = subject.id; $store.quiz.getTopics(subject.id); step = 3;"
					class="block w-full px-4 py-2 border-b border-gray-200 cursor-pointer text-left"
					:class="$store.quiz.selection.subject_id === subject.id ? 'bg-blue-100 text-blue-700' : 'hover:bg-gray-100 hover:text-blue-700'">					
					<i class="fas fa-book text-lg text-gray-600"></i>
					<span class="ml-2" x-text="subject.name"></span>
				</button>
			</template>
		</div>
		<!-- Step 3: Select Topic -->
		<div x-show="step === 3" class="w-full text-sm font-medium text-gray-900 bg-white border border-gray-200 rounded-lg">
			<template x-for="topic in $store.quiz.list.topics" :key="topic.id">
				<button @click="$store.quiz.selection.topic_id = topic.id; $store.quiz.getRoadmaps(topic.id); step = 4;"
					class="block w-full px-4 py-2 border-b border-gray-200 cursor-pointer text-left"
					:class="$store.quiz.selection.topic_id === topic.id ? 'bg-blue-100 text-blue-700' : 'hover:bg-gray-100 hover:text-blue-700'">
					<i class="fas fa-list text-lg text-gray-600"></i>
					<span class="ml-2" x-text="topic.name"></span>
				</button>
			</template>
		</div>
		<!-- Step 4: Select Roadmap -->
		<div x-show="step === 4" class="w-full text-sm font-medium text-gray-900 bg-white border border-gray-200 rounded-lg">
			<template x-for="roadmap in $store.quiz.list.roadmaps" :key="roadmap.id">
				<button @click="$store.quiz.selection.roadmap_id = roadmap.id; step = 5;"
					class="block w-full px-4 py-2 border-b border-gray-200 cursor-pointer text-left"
					:class="$store.quiz.selection.roadmap_id === roadmap.id ? 'bg-blue-100 text-blue-700' : 'hover:bg-gray-100 hover:text-blue-700'">
					<i class="fas fa-road text-lg text-gray-600"></i>
					<span class="ml-2" x-text="roadmap.name"></span>
				</button>
			</template>
		</div>
		<!-- Step 5: Levels -->
		<div x-show="step === 5" class="w-full text-sm font-medium text-gray-900 bg-white border border-gray-200 rounded-lg">
			<template x-for="level in $store.quiz.list.levels" :key="level.id">
				<button @click="$store.quiz.selection.level_id = level.id; step = 6;"
					class="block w-full px-4 py-2 border-b border-gray-200 cursor-pointer text-left"
					:class="$store.quiz.selection.level_id === level.id ? 'bg-blue-100 text-blue-700' : 'hover:bg-gray-100 hover:text-blue-700'">
					<i :class="`fas ${level.icon} text-lg text-gray-600`"></i>
					<span class="ml-2" x-text="level.name"></span>
				</button>
			</template>
		</div>
		<!-- Step 6: Quiz -->
		<div x-show="step === 6" class="text-lg text-gray-700 w-full">
			<div class="table-responsive paper">
				<table class="table border strip">
					<thead>
						<tr>
							<th>Platform</th>
							<th>Subject</th>
							<th>Topic</th>
							<th>Roadmap</th>
							<th>Level</th>
						</tr>
					</thead>
					<tbody>
						<template x-for="r in $store.quiz.items" :key="r.id">
							<tr>
								<td x-text="r.platform"></td>
								<td x-text="r.subject"></td>
								<td x-text="r.topic"></td>
								<td x-text="r.roadmap"></td>
								<td x-text="r.level"></td>
							</tr> 
						</template>
					</tbody>
				</table>
			</div>
		</div>
	</div>
	
		<!-- <div class="space-y-6">
			{
				questions.qz.map((item: any, index: number) => (
					<div class="p-5 border rounded-lg shadow-sm bg-gray-50">
						<h2 class="text-lg font-semibold text-gray-900">
							{index + 1}. {item.q}
						</h2>

						<ul class="mt-3 space-y-2">
							{item.o.map((option: any, idx: number) => (
								<li class="flex gap-2 items-start">
									<span class="font-semibold">
										{String.fromCharCode(97 + idx)}.
									</span>
									<span>{option}</span>
								</li>
							))}
						</ul>

						<p class="mt-4 text-green-600 font-semibold">
							âœ… Correct Answer: {item.o[item.a]}
						</p>

						<p class="mt-2 text-gray-700 italic">
							ðŸ’¡ Explanation: {item.e}
						</p>
					</div>
				))
			}
		</div> -->
	
</LayoutFull>
